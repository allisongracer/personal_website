[
  {
    "path": "posts/2022-01-23-welcome/",
    "title": "Mono Lake Water Levels",
    "description": "A visual history",
    "author": [
      {
        "name": "Allison Gracer",
        "url": {}
      }
    ],
    "date": "2022-03-11",
    "categories": [],
    "contents": "\n\n\nhide\n\n# read in the data\nmono_lake <- read_csv(here(\"data\", \"mono_lake_annual_levels.csv\"),\n                           skip = 5) %>% \n  clean_names()\n\n\n\n\n\nhide\n\n# visualize the data\nggplot(data = mono_lake, aes(x = year, y = lake_level_feet_above_sea_level)) + # create ggplot\n  geom_line(color = \"cadetblue4\") + # specify plot type, and customize line color\n  geom_ribbon(aes(ymin = 6350, # create fill for the water levels, set min\n                  ymax = lake_level_feet_above_sea_level), #set fill max\n              fill = \"lightcyan2\") + # customize fill color\n  labs(x= \"\\nYear\\n\", # label x-axis\n       y = \"\\nLake level\\n(Feet above sea level)\\n\", # label y-axis\n       title = \"Mono Lake Levels 1850-2017\") + # create a title\n  theme_bw() + # customize theme\n  theme(plot.title = element_text(hjust = 0.5, # center the tile\n                                  size = 14, # change title font size\n                                  face = \"bold\")) + # change title font to bold\n  theme(plot.background = element_rect(fill = \"burlywood\"), # change plot background color\n        panel.background = element_rect(fill = \"ivory1\")) + #change panel background color\n  theme(plot.margin = margin(t = 10, # top margin\n                             r = 30, # right margin\n                             b = 5, # bottom margin\n                             l = 1)) + # left margin\n  theme(panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank()) +\n  scale_x_continuous(limit = c(1850,2017), # set limits of x-axis\n                     breaks = c(1850, 1875, 1900, 1925, 1950, 1975, 2000, 2017), # specify breaks\n                     expand = c(0,0)) + # adjust axis margins\n  scale_y_continuous(limit = c(6350, 6435), # set limits of y-axis\n                     breaks = c(6350, 6370, 6390, 6410, 6430),  # specify breaks\n                     expand = c(0,0)) + # adjust axis margins\n  geom_line(aes(y = 6377), # add another line to the graph to indicate important water levels\n            color = \"sienna4\", # customize line color\n            linetype = \"dotted\") + # customize line type\n  geom_line(aes(y = 6360), # add another line to the graph to indicate important water levels\n            color = \"sienna4\", # customize line color\n            linetype = \"dotted\") + # customize line type\n  annotate(\"text\", # add text labels, indicate location, color, and size\n           label = \"6,377 feet - land bridges emerge\",\n           x = 1875, # label position on x-axis\n           y = 6380, # label position on y-axis\n           color =\"sienna4\", #label font color\n           size = 2.75) + # label font size\n  annotate(\"text\", # add text labels, indicate location, color, and size\n           label = \"6360 feet - birds food sources decline\", # label title\n           x = 1879, # label position on x-axis\n           y = 6363, # label position on y-axis\n           color = \"sienna4\", # label font color\n           size = 2.75) + # label font size\n  geom_segment(aes(x = 1941, # add an arrow to indicate 1941 water diversion to LA\n                   xend = 1941,\n                   y = 6420,\n                   yend = 6429),\n               color = \"sienna4\",\n               arrow = arrow(ends = \"first\", # set the arrow facing down\n                             type = \"open\", # set arrow point to open (not filled in)\n                             length = unit(.3, \"cm\"))) + # set arrow point length\n  annotate(\"text\", # add text labels, indicate location, color, and size\n           label = \"1941 - water diversion to LA begins\",\n           x = 1941, # label position on x-axis\n           y = 6432, # label position on y-axis\n           color = \"sienna4\", # label font color\n           size = 2.75) + # label font size\n  geom_segment(aes(x = 1983, # add an arrow to indicate 1983 CA Supreme Court ruling\n                   xend = 1983, # x-axis end point\n                   y = 6381, # y-axis start point\n                   yend = 6390), # y-axis line end point\n               color = \"sienna4\", # arrow color\n               arrow = arrow(ends = \"first\", # set the arrow facing down\n                             type = \"open\", # set arrow point to open (not filled in)\n                             length = unit(.3, \"cm\"))) +  # set arrow point length\n    annotate(\"text\", # add text labels, indicate location, color, and size\n           label = \"1983 - CA Supreme Court protection\",\n           x = 1990, # label position on x-axis\n           y = 6393, # label position on y-axis\n           color = \"sienna4\", # label font color\n           size = 2.75)\n\n\n\n\nFigure 1: This figure depicts the recent history of Mono Lake water levels from 1850-2017. In 1941 the Los Angeles Department of Water & Power (DWP) began diverting water to supply the growing demand of water for Los Angeles. This diversion of water had profound effects on Mono Lake water and salinity levels, and resulted in a number of ecological impacts. Around 1976 the lake levels dropped to 6,377 feet, land bridges emerged allowing predators access to islands that had previously been safe nesting grounds for California Gulls. In 1983 the California Supreme Court sided with the Mono Lake Committee (est. 1979) ruling that the state of California had an obligation to protect Mono Lake, even if that meant finding other sources of water for Los Angeles. A study published in 1987 by the Mono Basin Ecosystem Study Committee determined a decrease in bird food sources would occur at lake levels of 6,360 feet.\nData Citation: Mono Basin Clearinghouse\n\n\n\n",
    "preview": "posts/2022-01-23-welcome/welcome_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-03-11T23:44:56-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-03-11-palmeto/",
    "title": "Binary Logistic Regression on Palmetto Species",
    "description": {},
    "author": [
      {
        "name": "Allison Gracer",
        "url": {}
      }
    ],
    "date": "2022-03-11",
    "categories": [],
    "contents": "\n\n\nhide\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\n\n# attach packages\nlibrary(tidyverse)\nlibrary(here)\nlibrary(GGally)\nlibrary(patchwork)\nlibrary(AICcmodavg)\nlibrary(caret)\nlibrary(broom)\nlibrary(kableExtra)\nlibrary(janitor)\n\n\n\nOverview\nThis report uses binary logistic regression to determine the predictive capacity of the variables plant height (cm), canopy length(cm), canopy width (cm), and number of green leaves to determine whether a palmetto is species Serenoa repens or Sabal etonia. The data set contains survival and growth data across multiple years, habitats and experimental treatments of two dominant palmetto species, Serenoa repens and Sabal etonia, at Archbold Biological Station in south-central Florida from 1981 - 2017, ongoing at 5-year intervals.\nData Citation: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5\nData wrangling & visualization\n\n\nhide\n\n# read in the data\n\npalmetto <- read_csv(here(\"data\", \"palmetto.csv\"))\n\n\n\n\n\nhide\n\n# First I clean up the data by selecting only the columns that I am interested in, applying species scientific names to the data rather than numbers, and dropping NA values. Finally I convert species names to factors for later use in binary logistic regression.\n\npalmetto_clean <- palmetto %>% \n  select(year, species, height, length, width, green_lvs) %>% \n  mutate(species_name = case_when (species == \"1\" ~ \"Serenoa repens\",\n                              species == \"2\" ~ \"Sabal etonia\")) %>% \n  drop_na() %>% \n  mutate(species_name = as.factor(species_name))\n\n\n\n\n\nhide\n\n# Initial exploration of variables using ggpairs to assess predictor variables\n\npalmetto_clean %>% \n  select(species_name, height:green_lvs) %>% \n  ggpairs(aes(color = species_name))\n\n\n\n\n\nhide\n\n# Create a summary of means for analysis and in-line coding\n\npalmetto_summary <- palmetto_clean %>% \n  group_by(species_name) %>% \n  summarize(count = n(),\n            mean_height = round(mean(height, na.rm = TRUE), 2),\n            mean_length = round(mean(length, na.rm = TRUE), 2),\n            mean_width = round(mean(width, na.rm = TRUE), 2),\n            mean_green_lvs = round(mean(green_lvs, na.rm = TRUE), 2))\n\n\n\n\n\nhide\n\n# create three finalized data visualizations that explore differences between the two species, Serenoa repens and Sabal etonia with the following variables of interest: height (cm), canopy length (cm), canopy width (cm), and number of green leaves. \n\n\n# Plot 1\n\np1 <- ggplot(palmetto_clean, aes(x = species_name, y = height, fill = species_name)) +\n  geom_violin(scale = \"count\", color = \"black\") +\n  geom_boxplot(color = \"black\", fill = NA, width = 0.2, outlier.color = NA) +\n  stat_summary(fun = mean, \n               geom = \"point\", \n               shape = 20, \n               size = 4, \n               color = \"black\", \n               fill = \"black\") +\n  scale_fill_manual(values = c(\"seagreen\", \"olivedrab3\")) +\n  theme_minimal() + \n  theme(legend.position = \"none\") +\n  labs(x = element_blank(), y = \"\\nHeight (cm)\\n\") +\n  scale_x_discrete(labels = function(x) str_wrap(x, width = 5)) +\n  ggtitle(\"A\")\n\n\n# Plot 2\n\np2 <- ggplot(palmetto_clean, aes(x = species_name, y = length, fill = species_name)) +\n   geom_violin(scale = \"count\", color = \"black\") +\n  geom_boxplot(color = \"black\", fill = NA, width = 0.2, outlier.color = NA) +\n  stat_summary(fun = mean, \n               geom = \"point\", \n               shape = 20, \n               size = 4, \n               color = \"black\", \n               fill = \"black\") +\n  scale_fill_manual(values = c(\"seagreen\", \"olivedrab3\")) +\n  theme_minimal() + \n  theme(legend.position = \"none\") +\n  labs(x = element_blank(), y = \"\\nLength (cm)\\n\") +\n  scale_x_discrete(labels = function(x) str_wrap(x, width = 5)) +\n  ggtitle(\"A\")\n\n# Plot 3\n\np3 <- ggplot(palmetto_clean, aes(x = species_name, y = width, fill = species_name)) +\n   geom_violin(scale = \"count\", color = \"black\") +\n  geom_boxplot(color = \"black\", fill = NA, width = 0.2, outlier.color = NA) +\n  stat_summary(fun = mean, \n               geom = \"point\", \n               shape = 20, \n               size = 4, \n               color = \"black\", \n               fill = \"black\") +\n  scale_fill_manual(values = c(\"seagreen\", \"olivedrab3\")) +\n  theme_minimal() + \n  theme(legend.position = \"none\") +\n  labs(x = element_blank(), y = \"\\nWidth (cm)\\n\") +\n  scale_x_discrete(labels = function(x) str_wrap(x, width = 5)) +\n  ggtitle(\"B\")\n\n# Plot 4\n\np4 <- ggplot(palmetto_clean, aes(x = species_name, y = green_lvs, fill = species_name)) +\n  geom_violin(scale = \"count\", color = \"black\") +\n  geom_boxplot(color = \"black\", fill = NA, width = 0.2, outlier.color = NA) +\n  stat_summary(fun = mean, \n               geom = \"point\", \n               shape = 20, \n               size = 4, \n               color = \"black\", \n               fill = \"black\") +\n  scale_fill_manual(values = c(\"seagreen\", \"olivedrab3\")) +\n  theme_minimal() + \n  theme(legend.position = \"none\") +\n  labs(x = element_blank(), y = \"\\nGreen Leaf Counts\\n\") +\n  scale_x_discrete(labels = function(x) str_wrap(x, width = 5)) +\n  ggtitle(\"B\")\n\n\n\n\n\nhide\n\n# combine all three graphs with patchwork\n\np2+p4\n\n\n\nhide\n\np1+p3\n\n\n\n\nFigure 1: These graphs explore differences in predictor variables for two palmetto species. The shapes represent the quantity of observations at a given value. Box endpoints indicate the 25th and 75th percentile values; the black line and black point within the box indicate the median and mean value for each species, respectively. Plot (A) shows length (cm) for both species. The absolute difference in mean length between the two species is 23.28 centimeters, (a 11.45 % difference). Plot (B) looks at the count of green leaves for both species. The absolute difference in mean green leaf count is 3.48, (a 36.59 % difference).\nFigure 2: These graphs explore differences in predictor variables for two palmetto species. The shapes represent the quantity of observations at a given value. Box endpoints indicate the 25th and 75th percentile values; the black line and black point within the box indicate the median and mean value for each species, respectively. Plot (A) shows height (cm) for both species. The absolute difference in mean height between the two species is 2.1 centimeters, (a 1.53 % difference). Plot (B) shows width(cm) for both species. The absolute difference in mean width between the two species is 7.31 centimeters, (a 4.91 % difference).\nBased on the above analysis of all four variables, green leaf count has the most predictive capacity, followed by length, then width and height.\nBinomial logistic regression\nRunning binomial logistic regression(BLR) for two models to try to determine the probability of a palmetto species based on several predictor variables.\nModel 1: Palmetto species as a function of maximum plant height, canopy length, canopy width, and number of green leaves\nModel 2: Palmetto species as a function of maximum plant height, canopy width, and green leaves\n\n\nhide\n\n# checking factor levels - Sabal etonia is the first '0' factor, or reference level and Serenoa repens is second factor or '1'\nlevels(palmetto_clean$species_name)\n\n#(a `r round((palmetto_summary$mean_length[2] - palmetto_summary$mean_length[1]/((palmetto_summary$mean_length[2]+ palmetto_summary$mean_length[1]/2)*100, 2)`) \n\n\n\n\n\nhide\n\n# creating and storing functions\nf1 <- species_name ~ height + length + width + green_lvs\n\nf2 <- species_name ~ height + width + green_lvs\n\n\n# creating the regressions for each model\nblr1 <- glm(formula = f1,\n            data = palmetto_clean,\n            family = \"binomial\")\n\nblr2 <- glm(formula = f2,\n            data = palmetto_clean,\n            family = \"binomial\")\n\n\n\n\n\nhide\n\n# looking at blr results\nsummary(blr1)\nsummary(blr2)\n\n\n\nModel selection\nAICc\n\n\nhide\n\naic_mod <- AICcmodavg::aictab(list(blr1, blr2))\n\n\n\nModel 1 AICc is 5194.57\nModel 2 AICc is 5987.48\nThe difference in AIC between Model 1 and Model 2 is 792.91. Since the difference in AIC between the models is significantly large, we accept that Model 1 is a much better fit than model 2.\n10-fold cross validation\n\n\nhide\n\n# Use the caret package to automate a 10-fold cross-validation. Use prediction accuracy as our metric.\n\nset.seed(123)\ntr_ctrl <- trainControl(method = \"repeatedcv\", number = 10, repeats = 10)\n\n# Train model 1\nmodel1 <- train(f1, data = palmetto_clean, \n                method = \"glm\",\n                family = \"binomial\",\n                trControl = tr_ctrl)\n\n# accuracy = 0.917\n\n# Train model 2\nmodel2 <- train(f2, data = palmetto_clean, \n                method = \"glm\",\n                family = \"binomial\",\n                trControl = tr_ctrl)\n\n# accuracy = 0.899\n\n\n\nModel selection results Model 1 used the following predictor variables: plant height, canopy length, canopy width, and green leaf counts and had an accuracy of 91.7% in the 10-fold cross validation with an AICc = 5194.57. Contrastingly, model 2 used the following predictor variables: plant height, canopy width, and green leaf counts and had an accuracy of 89.9% in the 10-fold cross validation with an AICc = 5987.48. Based on the AICc values and the predicted accuracy of these two models, this analysis concludes that model 1 is superior.\nBLR model results\nTable 1: Summarized results of BLR for model 1 with sabal etonia as the reference species.\n\n\nhide\n\n# train the selected model using the entire data set and format data for table\nblr1_tidy <- tidy(blr1) %>% \n  select(-statistic) %>% \n  mutate(p.value = case_when(p.value < 0.001 ~ \"<0.001\")) %>% \n  mutate(term = case_when(term == \"(Intercept)\" ~ \"Intercept\",\n                          term == \"height\" ~ \"Height\",\n                          term == \"length\" ~ \"Length\",\n                          term == \"width\" ~ \"Width\",\n                          term == \"green_lvs\" ~ \"Green leaf counts\"))\n\n# create a finalized table for presentation\n  kable(blr1_tidy,\n        col.names = c(\"Variable\", \"Coefficient\", \"Standard Error\", \"P Value\"),\n        align = 'c',\n        digits = 3) %>% \n  kable_paper()\n\n\n\nVariable\n\n\nCoefficient\n\n\nStandard Error\n\n\nP Value\n\n\nIntercept\n\n\n-3.227\n\n\n0.142\n\n\n<0.001\n\n\nHeight\n\n\n0.029\n\n\n0.002\n\n\n<0.001\n\n\nLength\n\n\n-0.046\n\n\n0.002\n\n\n<0.001\n\n\nWidth\n\n\n-0.039\n\n\n0.002\n\n\n<0.001\n\n\nGreen leaf counts\n\n\n1.908\n\n\n0.039\n\n\n<0.001\n\n\nModel success\nTable 2: Summarized results of the success of model 1 at accurately predicting palmetto species once trained and applied to the full data set.\n\n\nhide\n\n# use broom::augment to add predicted species to data set\nblr1_predicted = blr1 %>% \n  broom::augment(type.predict = \"response\") %>% \n  mutate(\"predicted_classification\" = case_when(.fitted < .5 ~ \"Sabal etonia\",\n                               .fitted > .5 ~ \"Serenoa repens\")) %>% \n  mutate(\"accurate_classification\" = case_when(species_name == predicted_classification ~ \"Yes\",\n                                        species_name != predicted_classification ~ \"No\" ))\n\n# Create a table of prediction accuracy \n\nprediction_acc_table = blr1_predicted %>% \n  tabyl(species_name, accurate_classification) %>% \n  adorn_percentages() %>% \n  adorn_pct_formatting(digits = 1) %>% \n  adorn_ns() %>% \n  select(species_name, Yes, No) # rename and order my column titles for presentation purposes\n\n\n# finalize table for presentation\n\nkable(prediction_acc_table, \n      col.names = c(\"Palmetto Species\", \n                    \"Correct\", \n                    \"Incorrect\"),\n      align = \"c\",) %>% \n  kable_paper()\n\n\n\nPalmetto Species\n\n\nCorrect\n\n\nIncorrect\n\n\nSabal etonia\n\n\n92.6% (5701)\n\n\n7.4% (454)\n\n\nSerenoa repens\n\n\n90.8% (5548)\n\n\n9.2% (564)\n\n\nThe selected model correctly predicted Sabal etonia with a 92.6% accuracy and Serenoa repens with a 90.8% accuracy. Overall, the model accurately classified 11,249 of 12,267 total observations based on plant height(cm), canopy width(cm), canopy length(cm) and green leaf counts.\n\n\n\n",
    "preview": "posts/2022-03-11-palmeto/palmeto_files/figure-html5/unnamed-chunk-6-1.png",
    "last_modified": "2022-03-11T23:45:44-08:00",
    "input_file": {}
  }
]
